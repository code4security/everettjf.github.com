---
layout: post
title: （编写中）如何编写一个简单的博客RSS阅读器，番茄阅读的开发总结
excerpt: "简单说下 番茄阅读 的开发思路"
date: 2016-05-13
tags: [iOS开发]
comments: true
---


# 背景

`啰嗦，请直接忽略。但确实是这个过程。`

- 2014年10月份我还在做Windows开发，我想开发一个导航网站，精选各类优质开发类的网站。后来发现要耗费太多人力。
- 2015年5月份，我想开发一个分享自己收藏网址的网站。中间开发出了几个版本，但感觉使用麻烦（虽然做了Chrome插件）。（后来想到，直接把Chrome收藏夹发布出去，更简单、易用。但现在感觉也是伪需求，或者很小众。）
- 2016年找到几个有相同目标的小伙伴，做出了 钦慕网（https://admire.so）。但设计类网站太过追求漂亮，我又不想过多维护开发类的网址，就单独做出了个 http://iosblog.cc，专注于 iOS/OS X 开发者博客的收集。(这个网站也即将废弃，后面会有原因)
- 最后终于回到了本职工作。将收集的博客以及博客的RSS订阅信息通过App展示出来。
- 目标不断的在缩小，或许就是伪需求变为真实需求的过程。

# 架构
## 组成

- Web服务器
- 静态内容服务器
- 爬虫
- App

## Web服务器

Web服务器主要用于网址收集和删除。

为了能看到一个博客后，方便的收藏博客，可以编写一个`Chrome插件`。当浏览到一个博客网址后，点击Chrome插件，Chrome插件会自动收集当前博客的网址、标题、favicon。还可以添加订阅地址。

免去了使用文本方式记录博客的麻烦。

Web服务器使用Django实现。


## 静态内容服务器

阿里云或其他各种云的VPS最低配置一般一年600元左右，而且带宽性能都较差。可又为了能让App较快的获取数据，怎么办。想到平时的博客使用GitHub Pages。可以把平时收藏到的内容，定时导出为json文件放到GitHub Pages下（例如我的博客目录下）。

而阿里云服务器就不用担心带宽太小、配置太低的问题了。亚马逊的EC2最近还免费一年。

这一层服务器的存在，让我们可以随便更换Web服务器。App也不依赖Web服务器。


## 爬虫

有的博客是有RSS或Atom订阅的，但还有很多博客没有订阅。例如现在很火的`简书`。简书上有很多不错的 iOS/OS X 开发者博客。

收藏了一些不错的简书博客后，可以写个小爬虫，只爬指定博客的文章列表。App中点击这类文章时，直接以浏览器的方式打开。

scrapy是Python很好的爬虫框架，使用起来简单易用。


## App

### 开源库

为了快速组装这个App，可以使劲用现成的开源库。

主要：

- Rss/Atom解析 https://github.com/mwaterfall/MWFeedParser
- App 内嵌浏览器 https://github.com/dfmuir/KINWebBrowser

辅助：

- 自动布局：https://github.com/SnapKit/Masonry
- 网络：https://github.com/AFNetworking/AFNetworking
- 标签页：https://github.com/HeshamMegid/HMSegmentedControl
- JSON模型转换：https://github.com/ibireme/YYModel
- 日志：https://github.com/CocoaLumberjack/CocoaLumberjack
- 下拉刷新：https://github.com/CoderMJLee/MJRefresh
- 异步加载图片：https://github.com/ibireme/YYWebImage
- 动画：https://github.com/facebook/pop

### 加载策略

当一下子拿到40多个订阅地址，如何能在让用户感觉不到太慢的前提下，把文章加载下来。

- 服务器把更新比较频繁的、且优质的几个博客放在前面（排序靠前，增加zorder）
- 首次加载动画，在加载5个博客后，动画缩小到不影响用户使用的地方，继续加载剩余博客。
- 记录博客的最后文章更新日期，以后再次检测博客更新时，优先检查最近更新过的博客。（有一些开发者博客很久不更新文章了，但之前的文章写的很好。）尽量最快的显示出最新内容。
- 所有博客都加载完成后，可以让用户知道。并能方便的加载最新内容。

其他可优化想法：

- 每个博客一个权值，根据更新频率分配，在某些情况下可以直接忽略权值过低的博客。



### 订阅文章内容显示

RSS/Atom订阅拿到的文章内容是一段html代码。缺少css。程序内部要内置一套较为通用的css。




### 加载动画

类似MBProgressSUD的加载动画都是全局阻塞方式。不能满足 先加载5个博客后继续显示进度且不应影响用户使用的需求。于是自己造一个。

最近看最强大脑，在学习魔方算法，想来可以做个类似魔方的动画。为了简单、快速可用，可以用 facebook的 pop 库，9个颜色挨个淡入淡出，再加个状态栏。


### 工具

- 生成图标
- Photoshop


### 第三方服务
- 统计：友盟
- 崩溃分析：ugly
- 热修复：JSPatch

### 名称

- iOS博客精选：不能带有iOS
- 博客精选：太过大众化。
- 番茄阅读：加个副标题。相对好记一些。且算是有个小品牌。AppStore还没有同名的App。好，就这个了。


# 总结

自己做iOS工作接近一年了（中间暂停了3个月在家做奶爸了）,这是第一个上架的App。虽然App较为简单，但这个想法的演变过程，值得我反思和总结。






